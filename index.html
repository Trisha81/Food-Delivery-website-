<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Spice & Kitchen - Food Delivery</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* ====== Styling (kept consistent) ====== */
    *{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif}
    :root{--primary:#e23744;--secondary:#ff7e8b;--dark:#1c1c1c;--light:#f8f8f8;--gray:#a0a0a0;--success:#2ecc71;--warning:#f39c12}
    body{background:var(--light);color:var(--dark);line-height:1.6}
    .container{max-width:1200px;margin:0 auto;padding:0 20px}
    header{background:white;box-shadow:0 2px 10px rgba(0,0,0,0.1);position:sticky;top:0;z-index:100}
    .header-top{display:flex;justify-content:space-between;align-items:center;padding:15px 0}
    .logo{display:flex;align-items:center;font-size:24px;font-weight:700;color:var(--primary);text-decoration:none}
    .logo i{margin-right:8px}
    .search-bar{flex:1;max-width:500px;margin:0 20px;position:relative}
    .search-bar input{width:100%;padding:12px 20px;border-radius:30px;border:1px solid var(--gray);font-size:16px;outline:none}
    .search-bar i{position:absolute;right:20px;top:50%;transform:translateY(-50%);color:var(--gray)}
    .user-actions{display:flex;align-items:center}
    .user-actions a{margin-left:20px;text-decoration:none;color:var(--dark);font-weight:500;position:relative}
    .cart-count{position:absolute;top:-8px;right:-8px;background:var(--primary);color:white;border-radius:50%;width:18px;height:18px;font-size:12px;display:flex;align-items:center;justify-content:center}
    .user-actions .sign-in{background:var(--primary);color:white;padding:8px 16px;border-radius:20px}
    .header-nav{display:flex;overflow-x:auto;padding:15px 0;border-top:1px solid #eee}
    .header-nav a{margin-right:25px;text-decoration:none;color:var(--dark);white-space:nowrap;font-weight:500}
    .header-nav a.active{color:var(--primary);border-bottom:2px solid var(--primary);padding-bottom:5px}
    .hero{background:linear-gradient(rgba(0,0,0,.45),rgba(0,0,0,.45)),url('https://images.unsplash.com/photo-1504674900247-0877df9cc836?ixlib=rb-4.0.3&auto=format&fit=crop&w=1350&q=80');background-size:cover;background-position:center;height:380px;display:flex;align-items:center;justify-content:center;color:white;text-align:center;margin-bottom:30px}
    .hero-content h1{font-size:48px;margin-bottom:15px}
    .hero-content p{font-size:20px;margin-bottom:25px}
    .location-input{display:flex;max-width:500px;margin:0 auto}
    .location-input input{flex:1;padding:15px;border:none;border-radius:5px 0 0 5px;font-size:16px}
    .location-input button{background:var(--primary);color:white;border:none;padding:0 25px;border-radius:0 5px 5px 0;cursor:pointer;font-weight:600}
    .quick-filters{margin:30px 0}
    .section-title{font-size:24px;margin-bottom:20px;font-weight:600}
    .filters{display:flex;overflow-x:auto;gap:15px;padding-bottom:10px}
    .filter-item{display:flex;flex-direction:column;align-items:center;min-width:80px;text-decoration:none;color:var(--dark)}
    .filter-icon{width:60px;height:60px;border-radius:50%;background:white;display:flex;align-items:center;justify-content:center;margin-bottom:8px;box-shadow:0 2px 5px rgba(0,0,0,0.1)}
    .filter-icon i{font-size:24px;color:var(--primary)}
    .restaurant-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:25px;margin:30px 0}
    .restaurant-card{background:white;border-radius:10px;overflow:hidden;box-shadow:0 3px 10px rgba(0,0,0,0.1);transition:transform .3s;cursor:pointer}
    .restaurant-card:hover{transform:translateY(-5px)}
    .restaurant-image{height:180px;background-size:cover;background-position:center;position:relative}
    .discount-badge{position:absolute;top:10px;left:10px;background:var(--primary);color:white;padding:5px 10px;border-radius:3px;font-size:14px;font-weight:600}
    .restaurant-info{padding:15px}
    .restaurant-name{font-size:18px;font-weight:600;margin-bottom:5px}
    .restaurant-cuisine{color:var(--gray);margin-bottom:10px;font-size:14px}
    .restaurant-details{display:flex;justify-content:space-between;font-size:14px;color:var(--gray)}
    .rating{background:var(--success);color:white;padding:2px 6px;border-radius:3px;display:inline-flex;align-items:center}
    .menu-section{margin:30px 0}
    .menu-item{background:white;border-radius:10px;padding:15px;box-shadow:0 2px 8px rgba(0,0,0,0.1);display:flex;justify-content:space-between;align-items:center;cursor:pointer}
    .menu-item:hover{transform:translateY(-3px)}
    .item-info{flex:1}
    .item-name{font-weight:600;margin-bottom:5px}
    .item-price{color:var(--primary);font-weight:600;font-size:18px}
    .item-description{color:var(--gray);font-size:14px;margin:5px 0}
    .add-to-cart{background:var(--primary);color:white;border:none;padding:8px 15px;border-radius:5px;cursor:pointer;font-weight:600;display:inline-flex;align-items:center;gap:8px}
    .modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:1000}
    .modal-content{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:white;padding:30px;border-radius:10px;width:90%;max-width:520px;max-height:80vh;overflow-y:auto}
    .close-modal{position:absolute;right:15px;top:15px;font-size:24px;cursor:pointer;color:var(--gray)}
    .cart-items{margin:20px 0}
    .cart-item{display:flex;justify-content:space-between;align-items:center;padding:10px 0;border-bottom:1px solid #eee}
    .quantity-controls{display:flex;align-items:center;gap:10px}
    .quantity-btn{background:var(--primary);color:white;border:none;width:25px;height:25px;border-radius:50%;cursor:pointer}
    .checkout-btn{background:var(--success);color:white;border:none;padding:12px 30px;border-radius:5px;font-size:16px;font-weight:600;cursor:pointer;width:100%;margin-top:20px}
    .order-confirmation{text-align:center;padding:40px}
    .confirmation-icon{font-size:60px;color:var(--success);margin-bottom:20px}
    .page{display:none}
    .page.active{display:block}
    .toast{position:fixed;bottom:20px;right:20px;background:var(--success);color:white;padding:12px 20px;border-radius:5px;box-shadow:0 3px 10px rgba(0,0,0,0.2);z-index:1001;display:none}
    .new-modules{margin:50px 0}
    .modules-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:20px}
    .module-card{background:white;border-radius:10px;padding:20px;box-shadow:0 3px 10px rgba(0,0,0,0.1);text-align:center;transition:transform .3s;cursor:pointer;display:flex;flex-direction:column;align-items:center;gap:12px}
    .module-card:hover{transform:translateY(-5px)}
    .module-icon{font-size:40px;color:var(--primary);margin-bottom:5px;height:110px;width:100%;border-radius:8px;overflow:hidden;display:flex;align-items:center;justify-content:center;background:#fff}
    .module-icon img{width:100%;height:110px;object-fit:cover}
    .module-title{font-size:18px;font-weight:600;margin-bottom:10px}
    .module-description{color:var(--gray);font-size:14px}
    .checkout-form{background:white;padding:30px;border-radius:10px;box-shadow:0 3px 10px rgba(0,0,0,0.1);margin:30px 0}
    .form-group{margin-bottom:20px}
    .form-group label{display:block;margin-bottom:8px;font-weight:600}
    .form-group input,.form-group textarea,.form-group select{width:100%;padding:12px;border:1px solid #ddd;border-radius:5px;font-size:16px}
    .progress { height:10px; background:#eee; border-radius:6px; overflow:hidden; margin-top:10px; }
    .progress-bar { height:100%; width:0%; background:var(--primary); transition:width .6s ease; }
    .landing-tiles{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:20px;padding-top:40px;padding-bottom:40px}
    .tile{background:white;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,0.08);padding:18px;cursor:pointer;text-align:center;transition:transform .2s;display:flex;flex-direction:column;align-items:center;gap:12px;min-height:220px;justify-content:center}
    .tile:hover{transform:translateY(-6px)}
    .tile img{width:120px;height:120px;border-radius:12px;object-fit:cover}
    .tile-graphic{width:120px;height:120px;border-radius:12px;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#fff,#fff);border:1px solid #f0f0f0}
    .tile-graphic .fa{font-size:44px;color:var(--primary)}
    .avatar{width:36px;height:36px;border-radius:50%;overflow:hidden;margin-right:8px;border:2px solid #fff}
    .avatar img{width:100%;height:100%;object-fit:cover}
    footer{background:var(--dark);color:white;padding:50px 0 20px;margin-top:50px}
    .footer-content{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:30px;margin-bottom:30px}
    .footer-column h3{font-size:18px;margin-bottom:20px;position:relative;padding-bottom:10px}
    .footer-column h3::after{content:'';position:absolute;left:0;bottom:0;width:40px;height:2px;background:var(--primary)}
    .footer-column ul{list-style:none}
    .footer-column ul li{margin-bottom:10px}
    .footer-column ul li a{color:#ccc;text-decoration:none;transition:color .3s}
    .footer-column ul li a:hover{color:white}
    .footer-bottom{text-align:center;padding-top:20px;border-top:1px solid #444;color:#ccc;font-size:14px}
    @media (max-width:768px){.header-top{flex-direction:column;gap:15px}.search-bar{max-width:100%;margin:10px 0}.hero-content h1{font-size:36px}.hero-content p{font-size:18px}.restaurant-grid{grid-template-columns:repeat(auto-fill,minmax(250px,1fr))}.menu-items{grid-template-columns:1fr}.form-row{flex-direction:column;gap:0}.module-icon{height:90px}.tile img{width:100px;height:100px}}
    @media (max-width:480px){.hero{height:300px}.hero-content h1{font-size:28px}.restaurant-grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <!-- Toast -->
  <div class="toast" id="toast"></div>

  <!-- LANDING PAGE (first page) -->
  <div class="page active" id="landing-page">
    <header>
      <div class="container">
        <div class="header-top">
          <a href="#" class="logo" onclick="showPage('landing-page')"><i class="fas fa-utensils"></i> Spice & Kitchen</a>
          <div class="user-actions">
            <a href="#" id="cart-button-landing"><i class="fas fa-shopping-cart"></i> Cart <span class="cart-count" id="cart-count-landing">0</span></a>
          </div>
        </div>
      </div>
    </header>

    <section class="hero" style="background:linear-gradient(rgba(0,0,0,.45),rgba(0,0,0,.45)),url('https://images.unsplash.com/photo-1546069901-ba9599a7e63c?ixlib=rb-4.0.3&auto=format&fit=crop&w=1350&q=80');">
      <div class="hero-content">
        <h1>Welcome to Spice & Kitchen</h1>
        <p>Fresh food delivered fast — sign in to save favorites & track orders</p>
      </div>
    </section>

    <div class="container">
      <div class="landing-tiles">
        <!-- Login tile still has an image -->
        <div class="tile" id="tile-login">
          <img src="https://images.unsplash.com/photo-1526318472351-c75fcf070f52?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=60"
               alt="Login image"
               onerror="this.onerror=null;this.src='https://via.placeholder.com/240x240?text=Login';">
          <h3>Login</h3>
          <p style="color:var(--gray)">Access your account to view orders and favorites</p>
          <button class="add-to-cart" id="go-login" style="margin-top:8px"><i class="fas fa-sign-in-alt"></i> Login</button>
        </div>

        <!-- Signup: removed <img> and replaced with tile-graphic (no blank space) -->
        <div class="tile" id="tile-signup">
          <div class="tile-graphic"><i class="fas fa-user-plus"></i></div>
          <h3>Signup</h3>
          <p style="color:var(--gray)">Create an account to save preferences and faster checkout</p>
          <button class="add-to-cart" id="go-signup" style="margin-top:8px"><i class="fas fa-user-plus"></i> Sign Up</button>
        </div>

        <!-- Continue as Guest: removed <img> and replaced with tile-graphic -->
        <div class="tile" id="tile-guest">
          <div class="tile-graphic"><i class="fas fa-door-open"></i></div>
          <h3>Continue as Guest</h3>
          <p style="color:var(--gray)">Browse and order without creating an account</p>
          <button class="add-to-cart" id="continue-guest" style="margin-top:8px"><i class="fas fa-door-open"></i> Continue</button>
        </div>
      </div>
    </div>

    <footer style="margin-top:40px">
      <div class="container"><div class="footer-bottom"><p style="color:#aaa">&copy; 2025 Spice & Kitchen</p></div></div>
    </footer>
  </div>

  <!-- HOME PAGE -->
  <div class="page" id="home-page">
    <header>
      <div class="container">
        <div class="header-top">
          <a href="#" class="logo" onclick="showPage('home-page')"><i class="fas fa-utensils"></i> Spice & Kitchen</a>
          <div class="search-bar">
            <input id="search-input" type="text" placeholder="Search for restaurants or food...">
            <i class="fas fa-search"></i>
          </div>
          <div class="user-actions" id="header-user-actions">
            <!-- will be populated by JS to show Sign In or user avatar -->
            <a href="#" id="cart-button"><i class="fas fa-shopping-cart"></i> Cart <span class="cart-count" id="cart-count">0</span></a>
            <a href="#" class="sign-in" id="header-signin">Sign In</a>
          </div>
        </div>
        <div class="header-nav">
          <a href="#" class="active">Delivery</a>
          <a href="#" onclick="showPage('dining-page')">Dining Out</a>
          <a href="#" onclick="showPage('nightlife-page')">Nightlife</a>
          <a href="#" onclick="showPage('nutrition-page')">Nutrition</a>
          <a href="#" onclick="showPage('recipes-page')">Recipes</a>
          <a href="#" onclick="showPage('meal-plans-page')">Meal Plans</a>
          <a href="#" onclick="showPage('cooking-classes-page')">Cooking Classes</a>
          <a href="#" onclick="showPage('orders-page')">Track Orders</a>
        </div>
      </div>
    </header>

    <section class="hero">
      <div class="hero-content">
        <h1>Discover the best food & drinks</h1>
        <p>Order from your favorite restaurants or try something new</p>
        <div class="location-input">
          <input type="text" placeholder="Enter your delivery location" id="delivery-location">
          <button id="find-food">Find Food</button>
        </div>
      </div>
    </section>

    <div class="container">
      <section class="quick-filters">
        <h2 class="section-title">Quick Filters</h2>
        <div class="filters" id="filters">
          <a href="#" class="filter-item" data-category="pizza"><div class="filter-icon"><i class="fas fa-pizza-slice"></i></div><span>Pizza</span></a>
          <a href="#" class="filter-item" data-category="burgers"><div class="filter-icon"><i class="fas fa-hamburger"></i></div><span>Burgers</span></a>
          <a href="#" class="filter-item" data-category="desserts"><div class="filter-icon"><i class="fas fa-ice-cream"></i></div><span>Desserts</span></a>
          <a href="#" class="filter-item" data-category="cafe"><div class="filter-icon"><i class="fas fa-mug-hot"></i></div><span>Cafe</span></a>
          <a href="#" class="filter-item" data-category="healthy"><div class="filter-icon"><i class="fas fa-leaf"></i></div><span>Healthy</span></a>
          <a href="#" class="filter-item" data-category="fast-delivery"><div class="filter-icon"><i class="fas fa-bolt"></i></div><span>Fast Delivery</span></a>
          <a href="#" class="filter-item" data-category="top-rated"><div class="filter-icon"><i class="fas fa-star"></i></div><span>Top Rated</span></a>
        </div>
      </section>

      <section class="restaurants">
        <h2 class="section-title">Popular Restaurants Near You</h2>
        <div class="restaurant-grid" id="restaurant-grid"></div>
      </section>

      <section class="new-modules">
        <h2 class="section-title">Explore More with Spice & Kitchen</h2>
        <div class="modules-grid">
          <div class="module-card" onclick="showPage('meal-plans-page')">
            <div class="module-icon">
              <img src="https://images.unsplash.com/photo-1549576490-b0b4831ef60a?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=60"
                   alt="Meal Planning"
                   onerror="this.onerror=null;this.src='https://via.placeholder.com/800x110?text=Meal+Planning';">
            </div>
            <h3 class="module-title">Meal Planning</h3>
            <p class="module-description">Weekly meal plans with automatic ordering and delivery scheduling</p>
            <button class="add-to-cart" style="margin-top:8px"><i class="fas fa-calendar-plus"></i> Explore</button>
          </div>

          <div class="module-card" onclick="showPage('cooking-classes-page')">
            <div class="module-icon">
              <img src="https://images.unsplash.com/photo-1511688878355-3a0c66c7c2b1?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=60"
                   alt="Cooking Classes"
                   onerror="this.onerror=null;this.src='https://via.placeholder.com/800x110?text=Cooking+Classes';">
            </div>
            <h3 class="module-title">Cooking Classes</h3>
            <p class="module-description">Learn from master chefs with live virtual cooking classes</p>
            <button class="add-to-cart" style="margin-top:8px"><i class="fas fa-graduation-cap"></i> Join</button>
          </div>

          <div class="module-card" onclick="showPage('recipes-page')">
            <div class="module-icon">
              <img src="https://images.unsplash.com/photo-1478145046317-39f10e56b5e9?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=60"
                   alt="Recipe Community"
                   onerror="this.onerror=null;this.src='https://via.placeholder.com/800x110?text=Recipes';">
            </div>
            <h3 class="module-title">Recipe Community</h3>
            <p class="module-description">Share and discover recipes from our food lover community</p>
            <button class="add-to-cart" style="margin-top:8px"><i class="fas fa-utensils"></i> Explore</button>
          </div>

          <div class="module-card" onclick="showPage('nutrition-page')">
            <div class="module-icon">
              <img src="https://images.unsplash.com/photo-1544025162-d76694265947?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=60"
                   alt="Nutrition Tracking"
                   onerror="this.onerror=null;this.src='https://via.placeholder.com/800x110?text=Nutrition';">
            </div>
            <h3 class="module-title">Nutrition Tracking</h3>
            <p class="module-description">Track calories and nutrients in your ordered meals</p>
            <button class="add-to-cart" style="margin-top:8px"><i class="fas fa-apple-alt"></i> Track</button>
          </div>
        </div>
      </section>
    </div>
  </div>

  <!-- MENU PAGE -->
  <div class="page" id="menu-page">
    <header>
      <div class="container">
        <div class="header-top">
          <a href="#" class="logo" onclick="showPage('home-page')"><i class="fas fa-utensils"></i> Spice & Kitchen</a>
          <div class="search-bar"><input type="text" placeholder="Search for restaurants or food..."><i class="fas fa-search"></i></div>
          <div class="user-actions"><a href="#" id="cart-button-menu"><i class="fas fa-shopping-cart"></i> Cart <span class="cart-count" id="cart-count-menu">0</span></a><a href="#" class="sign-in" onclick="showPage('login-page')">Sign In</a></div>
        </div>
        <div class="header-nav"><a href="#" onclick="showPage('home-page')">← Back to Restaurants</a></div>
      </div>
    </header>

    <div class="container">
      <section class="menu-section">
        <h2 class="section-title" id="restaurant-menu-title">Menu</h2>
        <div id="menu-categories"></div>
      </section>
    </div>
  </div>

  <!-- CHECKOUT PAGE -->
  <div class="page" id="checkout-page">
    <header>
      <div class="container">
        <div class="header-top">
          <a href="#" class="logo" onclick="showPage('home-page')"><i class="fas fa-utensils"></i> Spice & Kitchen</a>
          <div class="user-actions"><a href="#" class="sign-in" onclick="showPage('login-page')">Sign In</a></div>
        </div>
        <div class="header-nav"><a href="#" onclick="showPage('home-page')">← Back to Home</a></div>
      </div>
    </header>

    <div class="container">
      <h1 class="section-title">Checkout</h1>
      <div class="checkout-form">
        <h2>Delivery Details</h2>
        <div class="form-group"><label for="name">Full Name</label><input type="text" id="name" placeholder="Enter your full name"></div>
        <div class="form-group"><label for="phone">Phone Number</label><input type="tel" id="phone" placeholder="Enter your phone number"></div>
        <div class="form-group"><label for="address">Delivery Address</label><textarea id="address" rows="3" placeholder="Enter your complete address"></textarea></div>
        <div class="form-row" style="display:flex;gap:15px">
          <div class="form-group" style="flex:1"><label for="city">City</label><input type="text" id="city" placeholder="Enter your city"></div>
          <div class="form-group" style="flex:1"><label for="pincode">Pincode</label><input type="text" id="pincode" placeholder="Enter pincode"></div>
        </div>

        <h2 style="margin-top:30px">Payment Method</h2>
        <div class="form-group"><select id="payment-method"><option value="">Select Payment Method</option><option value="card">Credit/Debit Card</option><option value="upi">UPI</option><option value="cash">Cash on Delivery</option></select></div>

        <div id="card-details" style="display:none">
          <div class="form-group"><label for="card-number">Card Number</label><input type="text" id="card-number" placeholder="Enter card number"></div>
          <div class="form-row" style="display:flex;gap:15px">
            <div class="form-group" style="flex:1"><label for="expiry">Expiry Date</label><input type="text" id="expiry" placeholder="MM/YY"></div>
            <div class="form-group" style="flex:1"><label for="cvv">CVV</label><input type="text" id="cvv" placeholder="CVV"></div>
          </div>
        </div>

        <div id="upi-details" style="display:none">
          <div class="form-group"><label for="upi-id">UPI ID</label><input type="text" id="upi-id" placeholder="Enter UPI ID"></div>
        </div>

        <div class="order-summary" style="margin-top:30px;padding:20px;background:#f9f9f9;border-radius:8px">
          <h3>Order Summary</h3>
          <div id="checkout-items"></div>
          <div style="display:flex;justify-content:space-between;margin-top:15px;font-weight:600;font-size:18px"><span>Total:</span><span>₹<span id="checkout-total">0</span></span></div>
        </div>

        <button class="checkout-btn" id="place-order-btn"><i class="fas fa-credit-card"></i> Place Order</button>
      </div>
    </div>
  </div>

  <!-- MEAL PLANS PAGE -->
  <div class="page" id="meal-plans-page">
    <header>
      <div class="container">
        <div class="header-top">
          <a href="#" class="logo" onclick="showPage('home-page')"><i class="fas fa-utensils"></i> Spice & Kitchen</a>
          <div class="user-actions"><a href="#" class="sign-in" onclick="showPage('login-page')">Sign In</a></div>
        </div>
        <div class="header-nav"><a href="#" onclick="showPage('home-page')">← Back to Home</a></div>
      </div>
    </header>

    <div class="container">
      <h1 class="section-title">Meal Plans</h1>
      <div class="modules-grid">
        <div class="module-card">
          <div class="module-icon">
            <img src="https://images.unsplash.com/photo-1544025162-d76694265947?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=60"
                 alt="Weight Loss Plan"
                 onerror="this.onerror=null;this.src='https://via.placeholder.com/800x110?text=Weight+Loss+Plan';">
          </div>
          <h3 class="module-title">Weight Loss Plan</h3>
          <p class="module-description">1200-1500 calories per day with balanced nutrition</p>
          <button class="add-plan-btn add-to-cart" data-title="Weight Loss Plan" data-price="2999" style="margin-top:15px"><i class="fas fa-bolt"></i> Subscribe - ₹2999/month</button>
        </div>
        <div class="module-card">
          <div class="module-icon">
            <img src="https://images.unsplash.com/photo-1526318472351-c75fcf070f52?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=60"
                 alt="Muscle Gain Plan"
                 onerror="this.onerror=null;this.src='https://via.placeholder.com/800x110?text=Muscle+Gain+Plan';">
          </div>
          <h3 class="module-title">Muscle Gain Plan</h3>
          <p class="module-description">High protein meals for muscle building</p>
          <button class="add-plan-btn add-to-cart" data-title="Muscle Gain Plan" data-price="3499" style="margin-top:15px"><i class="fas fa-dumbbell"></i> Subscribe - ₹3499/month</button>
        </div>
        <div class="module-card">
          <div class="module-icon">
            <img src="https://images.unsplash.com/photo-1478145046317-39f10e56b5e9?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=60"
                 alt="Heart Healthy Plan"
                 onerror="this.onerror=null;this.src='https://via.placeholder.com/800x110?text=Heart+Healthy+Plan';">
          </div>
          <h3 class="module-title">Heart Healthy Plan</h3>
          <p class="module-description">Low sodium, low cholesterol meals</p>
          <button class="add-plan-btn add-to-cart" data-title="Heart Healthy Plan" data-price="2799" style="margin-top:15px"><i class="fas fa-heart"></i> Subscribe - ₹2799/month</button>
        </div>
        <div class="module-card">
          <div class="module-icon">
            <img src="https://images.unsplash.com/photo-1549576490-b0b4831ef60a?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=60"
                 alt="Vegetarian Plan"
                 onerror="this.onerror=null;this.src='https://via.placeholder.com/800x110?text=Vegetarian+Plan';">
          </div>
          <h3 class="module-title">Vegetarian Plan</h3>
          <p class="module-description">Plant-based meals with complete nutrition</p>
          <button class="add-plan-btn add-to-cart" data-title="Vegetarian Plan" data-price="2599" style="margin-top:15px"><i class="fas fa-seedling"></i> Subscribe - ₹2599/month</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ORDERS / TRACKING PAGE -->
  <div class="page" id="orders-page">
    <header>
      <div class="container">
        <div class="header-top">
          <a href="#" class="logo" onclick="showPage('home-page')"><i class="fas fa-utensils"></i> Spice & Kitchen</a>
        </div>
        <div class="header-nav"><a href="#" onclick="showPage('home-page')">← Back to Home</a></div>
      </div>
    </header>
    <div class="container" style="padding:30px 0;">
      <h1 class="section-title">Track Your Order</h1>
      <div id="track-area">
        <p style="color:var(--gray)">If you have an order ID, enter it below to track your order.</p>
        <div style="max-width:480px;margin-top:15px;display:flex;gap:10px">
          <input id="track-order-input" placeholder="Enter order ID (e.g. SK12345)" style="flex:1;padding:12px;border:1px solid #ddd;border-radius:6px">
          <button class="add-to-cart" id="track-order-btn" style="background:var(--primary)"><i class="fas fa-search"></i> Track</button>
        </div>
        <div id="track-result" style="margin-top:20px"></div>
      </div>
    </div>
  </div>

  <!-- LOGIN PAGE -->
  <div class="page" id="login-page">
    <header><div class="container"><div class="header-top"><a href="#" class="logo" onclick="showPage('landing-page')"><i class="fas fa-utensils"></i> Spice & Kitchen</a></div><div class="header-nav"><a href="#" onclick="showPage('landing-page')">← Back</a></div></div></header>
    <div class="container" style="padding:30px 0;">
      <h1 class="section-title">Sign In</h1>
      <div style="max-width:420px">
        <div class="form-group"><label for="login-email">Email</label><input id="login-email" placeholder="you@example.com"></div>
        <div class="form-group"><label for="login-password">Password</label><input id="login-password" type="password" placeholder="password"></div>
        <button class="add-to-cart" id="btn-login" style="background:var(--primary)"><i class="fas fa-sign-in-alt"></i> Login</button>
      </div>
    </div>
  </div>

  <!-- SIGNUP PAGE -->
  <div class="page" id="signup-page">
    <header><div class="container"><div class="header-top"><a href="#" class="logo" onclick="showPage('landing-page')"><i class="fas fa-utensils"></i> Spice & Kitchen</a></div><div class="header-nav"><a href="#" onclick="showPage('landing-page')">← Back</a></div></div></header>
    <div class="container" style="padding:30px 0;">
      <h1 class="section-title">Create Account</h1>
      <div style="max-width:480px">
        <div class="form-group"><label for="signup-name">Full Name</label><input id="signup-name" placeholder="Your name"></div>
        <div class="form-group"><label for="signup-email">Email</label><input id="signup-email" placeholder="you@example.com"></div>
        <div class="form-group"><label for="signup-password">Password</label><input id="signup-password" type="password" placeholder="password"></div>
        <button class="add-to-cart" id="btn-signup" style="background:var(--primary)"><i class="fas fa-user-plus"></i> Create Account</button>
      </div>
    </div>
  </div>

  <!-- Cart Modal -->
  <div class="modal" id="cart-modal">
    <div class="modal-content">
      <span class="close-modal" id="close-cart">&times;</span>
      <h2><i class="fas fa-shopping-cart"></i> Your Cart</h2>
      <div class="cart-items" id="cart-items"></div>
      <div class="cart-total"><h3>Total: ₹<span id="cart-total">0</span></h3></div>
      <button class="checkout-btn" id="checkout-btn"><i class="fas fa-credit-card"></i> Proceed to Checkout</button>
    </div>
  </div>

  <!-- Order Confirmation Modal -->
  <div class="modal" id="order-confirmation">
    <div class="modal-content">
      <div class="order-confirmation">
        <div class="confirmation-icon"><i class="fas fa-check-circle"></i></div>
        <h2>Order Confirmed!</h2>
        <p>Your food is being prepared and will be delivered soon.</p>
        <p>Order ID: <strong id="order-id">SK#12345</strong></p>
        <p>Estimated delivery: <strong id="order-est">30-40 minutes</strong></p>
        <div style="display:flex;gap:10px;margin-top:16px;justify-content:center">
          <button class="checkout-btn" id="close-confirmation" style="background:var(--primary);width:auto;padding:10px 18px"><i class="fas fa-home"></i> Continue Shopping</button>
          <button class="checkout-btn" id="track-now-btn" style="background:#ff7e00;width:auto;padding:10px 18px"><i class="fas fa-map-marker-alt"></i> Track Order</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <div class="container">
      <div class="footer-content">
        <div class="footer-column">
          <h3>Spice & Kitchen</h3>
          <ul><li><a href="#">About Us</a></li><li><a href="#">Team</a></li><li><a href="#">Careers</a></li><li><a href="#">Blog</a></li></ul>
        </div>
        <div class="footer-column">
          <h3>Contact</h3>
          <ul><li><a href="#">Help & Support</a></li><li><a href="#">Partner with us</a></li><li><a href="#">Ride with us</a></li><li><a href="#">Contact Us</a></li></ul>
        </div>
        <div class="footer-column">
          <h3>Legal</h3>
          <ul><li><a href="#">Terms & Conditions</a></li><li><a href="#">Privacy Policy</a></li><li><a href="#">Cookie Policy</a></li><li><a href="#">Offer Terms</a></li></ul>
        </div>
        <div class="footer-column">
          <h3>Follow Us</h3>
          <ul><li><a href="#"><i class="fab fa-facebook"></i> Facebook</a></li><li><a href="#"><i class="fab fa-twitter"></i> Twitter</a></li><li><a href="#"><i class="fab fa-instagram"></i> Instagram</a></li><li><a href="#"><i class="fab fa-linkedin"></i> LinkedIn</a></li></ul>
        </div>
      </div>
      <div class="footer-bottom"><p>&copy; 2025 Spice & Kitchen. All rights reserved.</p></div>
    </div>
  </footer>

  <!-- ====== JavaScript: landing + auth + full site behavior ====== -->
  <script>
    /* -------------------------
       Data (restaurants + menus)
       - Pizza Palace and Sushi Central explicitly set to pizza/sushi images
       ------------------------- */
    const restaurants = [
      {
        id:1, name:"Pizza Palace", cuisine:"Italian, Pizza, Pasta", rating:4.5, deliveryTime:"30-40 min",
        image:"https://images.unsplash.com/photo-1601924582975-3e2876a4f9f6?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80", // pizza image
        discount:"30% OFF",
        menu:{
          "Pizzas":[
            {id:101,name:"Margherita Pizza",description:"Classic cheese and tomato",price:299},
            {id:102,name:"Pepperoni Pizza",description:"Spicy pepperoni",price:399},
            {id:103,name:"Veg Supreme",description:"Loaded with vegetables",price:449},
            {id:106,name:"BBQ Chicken Pizza",description:"Smoky BBQ chicken, onions",price:499},
            {id:107,name:"Paneer Tikka Pizza",description:"Indian spiced paneer",price:459}
          ],
          "Pasta":[
            {id:104,name:"Creamy Alfredo",description:"Creamy white sauce",price:249},
            {id:105,name:"Arrabbiata",description:"Spicy tomato pasta",price:229}
          ],
          "Desserts":[
            {id:108,name:"Tiramisu",description:"Classic Italian dessert",price:199},
            {id:109,name:"Chocolate Lava Cake",description:"Warm molten center",price:179}
          ]
        }
      },
      {
        id:2, name:"Burger Hub", cuisine:"Fast Food, Burgers", rating:4.3, deliveryTime:"25-35 min",
        image:"https://images.unsplash.com/photo-1550547660-d9450f859349?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80",
        discount:"20% OFF",
        menu:{
          "Burgers":[
            {id:201,name:"Classic Beef Burger",description:"Juicy beef patty",price:199},
            {id:202,name:"Chicken Crunch",description:"Crispy chicken burger",price:179},
            {id:203,name:"Veg Delight",description:"Grilled veggie patty",price:149},
            {id:210,name:"Double Cheese Burger",description:"Two patties with double cheese",price:279}
          ],
          "Sides":[
            {id:204,name:"French Fries",description:"Crispy salted fries",price:79},
            {id:205,name:"Onion Rings",description:"Crispy onion rings",price:99}
          ],
          "Shakes":[
            {id:206,name:"Classic Milkshake",description:"Vanilla / Chocolate / Strawberry",price:129}
          ]
        }
      },
      {
        id:3, name:"Green Kitchen", cuisine:"Healthy, Salad, Vegan", rating:4.6, deliveryTime:"35-45 min",
        image:"https://images.unsplash.com/photo-1504674900247-0877df9cc836?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80",
        discount:"10% OFF",
        menu:{
          "Salads":[
            {id:301,name:"Quinoa Salad",description:"Quinoa, veggies, lemon dressing",price:249},
            {id:302,name:"Greek Salad",description:"Olives, feta, crisp veggies",price:229},
            {id:311,name:"Caesar Salad",description:"Crisp lettuce, parmesan, dressing",price:239}
          ],
          "Bowls":[
            {id:303,name:"Protein Bowl",description:"Rice, beans, veggies",price:299},
            {id:304,name:"Vegan Buddha Bowl",description:"Quinoa, tofu, greens",price:319}
          ],
          "Smoothies":[
            {id:305,name:"Green Smoothie",description:"Spinach, banana, almond milk",price:149}
          ]
        }
      },
      {
        id:4, name:"Sushi Central", cuisine:"Japanese, Sushi", rating:4.7, deliveryTime:"40-55 min",
        image:"https://images.unsplash.com/photo-1542382256-5c2b1d7e7a19?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80", // sushi image
        discount:"15% OFF",
        menu:{
          "Sushi Rolls":[
            {id:401,name:"California Roll",description:"Crab, avocado, cucumber",price:399},
            {id:402,name:"Spicy Tuna Roll",description:"Tuna with spicy mayo",price:449},
            {id:403,name:"Veggie Roll",description:"Pickled veggies & avocado",price:349}
          ],
          "Sides":[
            {id:404,name:"Miso Soup",description:"Warm miso broth",price:99},
            {id:405,name:"Edamame",description:"Salted soybeans",price:129}
          ]
        }
      },
      {
        id:5, name:"Bombay Biryani House", cuisine:"Indian, Biryani", rating:4.8, deliveryTime:"35-45 min",
        image:"https://images.unsplash.com/photo-1604908813649-8e0efb1f0da2?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80",
        discount:"25% OFF",
        menu:{
          "Biryani":[
            {id:501,name:"Hyderabadi Chicken Biryani",description:"Aromatic basmati, spicy chicken",price:349},
            {id:502,name:"Veg Biryani",description:"Mixed veggies & saffron rice",price:279},
            {id:503,name:"Mutton Biryani",description:"Slow-cooked mutton with spices",price:399}
          ],
          "Raita & Sides":[
            {id:504,name:"Boondi Raita",description:"Cooling yogurt with boondi",price:59},
            {id:505,name:"Mirchi Ka Salan",description:"Spicy peanut curry",price:99}
          ]
        }
      }
    ];

    /* -------------------------
       State: cart, auth and orders
       ------------------------- */
    let cart = {}; // itemId -> { item, qty, restaurantId }
    let currentRestaurant = null;
    let lastOrder = null;
    let currentUser = null; // {name,email}
    // Try load persisted states
    try{ const s = localStorage.getItem('sk_cart'); if(s) cart=JSON.parse(s); }catch(e){}
    try{ const o = localStorage.getItem('sk_last_order'); if(o) lastOrder = JSON.parse(o);}catch(e){}
    try{ const u = localStorage.getItem('sk_user'); if(u) currentUser = JSON.parse(u);}catch(e){}
    try{ const users = localStorage.getItem('sk_users'); if(!users) localStorage.setItem('sk_users', JSON.stringify({})); }catch(e){}

    function persistCart(){ try{ localStorage.setItem('sk_cart', JSON.stringify(cart)); }catch(e){} }
    function persistLastOrder(){ try{ localStorage.setItem('sk_last_order', JSON.stringify(lastOrder)); }catch(e){} }
    function persistUser(){ try{ localStorage.setItem('sk_user', JSON.stringify(currentUser)); }catch(e){} }
    function formatPrice(n){ return Math.round(n); }
    function showToast(msg, t=2200){ const el=document.getElementById('toast'); el.textContent=msg; el.style.display='block'; clearTimeout(el._to); el._to=setTimeout(()=>el.style.display='none', t); }

    /* -------------------------
       Auth: signup, login, logout (mock + localStorage)
       ------------------------- */
    function signupUser(name,email,password){
      const users = JSON.parse(localStorage.getItem('sk_users') || '{}');
      if(users[email]) return { ok:false, message:'Account already exists for this email' };
      users[email] = { name, email, password };
      localStorage.setItem('sk_users', JSON.stringify(users));
      currentUser = { name, email };
      persistUser();
      updateHeaderForUser();
      return { ok:true };
    }
    function loginUser(email,password){
      const users = JSON.parse(localStorage.getItem('sk_users') || '{}');
      if(!users[email]) return { ok:false, message:'No account with this email' };
      if(users[email].password !== password) return { ok:false, message:'Incorrect password' };
      currentUser = { name: users[email].name, email };
      persistUser();
      updateHeaderForUser();
      return { ok:true };
    }
    function logoutUser(){
      currentUser = null;
      persistUser();
      updateHeaderForUser();
      showToast('Signed out');
      // go to landing page
      showPage('landing-page');
    }

    function updateHeaderForUser(){
      // Update header area in home page
      const container = document.getElementById('header-user-actions');
      if(!container) return;
      container.innerHTML = '';
      // cart link
      const cartLink = document.createElement('a'); cartLink.href='#'; cartLink.id='cart-button'; cartLink.innerHTML = '<i class="fas fa-shopping-cart"></i> Cart <span class="cart-count" id="cart-count">0</span>'; cartLink.addEventListener('click', (e)=>{ e.preventDefault(); openCartModal(); });
      container.appendChild(cartLink);
      if(currentUser){
        // avatar + name + sign out
        const userWrap = document.createElement('div'); userWrap.style.display='flex'; userWrap.style.alignItems='center'; userWrap.style.gap='8px';
        const avatar = document.createElement('div'); avatar.className='avatar'; avatar.innerHTML = '<img src="https://ui-avatars.com/api/?background=E23744&color=fff&name='+encodeURIComponent(currentUser.name)+'" onerror="this.onerror=null;this.src=\'https://via.placeholder.com/36x36?text=?\';">';
        const nameEl = document.createElement('span'); nameEl.style.fontWeight='600'; nameEl.textContent = currentUser.name;
        const signOut = document.createElement('a'); signOut.href='#'; signOut.style.marginLeft='10px'; signOut.textContent='Sign Out'; signOut.style.color='var(--primary)'; signOut.addEventListener('click', (e)=>{ e.preventDefault(); logoutUser(); });
        userWrap.appendChild(avatar); userWrap.appendChild(nameEl); userWrap.appendChild(signOut);
        container.appendChild(userWrap);
      } else {
        const signIn = document.createElement('a'); signIn.href='#'; signIn.className='sign-in'; signIn.id='header-signin'; signIn.textContent='Sign In'; signIn.addEventListener('click',(e)=>{ e.preventDefault(); showPage('login-page'); });
        container.appendChild(signIn);
      }
      // update cart counts visually
      updateCartUI();
    }

    /* -------------------------
       Render restaurants on home
       ------------------------- */
    const restaurantGrid = document.getElementById('restaurant-grid');
    function renderRestaurants(list = restaurants){
      restaurantGrid.innerHTML = '';
      if(!list.length){ restaurantGrid.innerHTML = '<p style="color:var(--gray)">No restaurants found.</p>'; return; }
      list.forEach(r=>{
        const a = document.createElement('article'); a.className='restaurant-card';
        a.innerHTML = `<div class="restaurant-image" style="background-image:url('${r.image}')">${r.discount?`<div class="discount-badge">${r.discount}</div>`:''}</div>
          <div class="restaurant-info"><div class="restaurant-name">${r.name}</div><div class="restaurant-cuisine">${r.cuisine}</div><div class="restaurant-details"><div class="rating">${r.rating} ★</div><div>${r.deliveryTime}</div></div></div>`;
        a.addEventListener('click', ()=> openMenuPage(r.id));
        restaurantGrid.appendChild(a);
      });
      // attempt background preloads for these images (to detect broken ones)
      setTimeout(preloadAndFallbackBackgrounds, 50);
    }

    /* -------------------------
       Menu: open and render items (click card to add)
       ------------------------- */
    function openMenuPage(restaurantId){
      currentRestaurant = restaurants.find(r=>r.id===restaurantId);
      if(!currentRestaurant) return showToast('Restaurant not found');
      document.getElementById('restaurant-menu-title').textContent = `${currentRestaurant.name} — Menu`;
      const categoriesContainer = document.getElementById('menu-categories'); categoriesContainer.innerHTML='';
      for(const [cat, items] of Object.entries(currentRestaurant.menu)){
        const catWrap = document.createElement('div'); catWrap.className='menu-category';
        catWrap.innerHTML = `<h3 class="category-title">${cat}</h3><div class="menu-items" data-category="${cat}"></div>`;
        const itemsDiv = catWrap.querySelector('.menu-items');
        items.forEach(it=>{
          const itemEl = document.createElement('div'); itemEl.className='menu-item';
          itemEl.innerHTML = `<div class="item-info"><div class="item-name">${it.name}</div><div class="item-description">${it.description||''}</div></div>
            <div style="display:flex;flex-direction:column;align-items:flex-end;gap:8px;"><div class="item-price">₹${formatPrice(it.price)}</div><button class="add-to-cart" data-id="${it.id}"><i class="fas fa-plus-circle"></i> Add</button></div>`;
          // clicking anywhere adds
          itemEl.addEventListener('click', (ev)=>{ addToCart(it, currentRestaurant.id); });
          // button add (stopPropagation)
          itemEl.querySelector('.add-to-cart').addEventListener('click', (ev)=>{ ev.stopPropagation(); addToCart(it, currentRestaurant.id); });
          itemsDiv.appendChild(itemEl);
        });
        categoriesContainer.appendChild(catWrap);
      }
      showPage('menu-page');
    }

    /* -------------------------
       Cart logic
       ------------------------- */
    function addToCart(item, restaurantId, qty=1){
      const existingRestaurantIds = new Set(Object.values(cart).map(ci=>ci.restaurantId));
      if(existingRestaurantIds.size && !existingRestaurantIds.has(restaurantId)){
        if(!confirm('Your cart contains items from another restaurant. Clear cart and add this item?')) return;
        cart = {};
      }
      if(!cart[item.id]) cart[item.id] = { item:{...item}, qty:0, restaurantId };
      cart[item.id].qty += qty;
      if(cart[item.id].qty <= 0) delete cart[item.id];
      persistCart(); updateCartUI(); showToast(`${item.name} added to cart`);
    }
    function removeFromCart(itemId){ delete cart[itemId]; persistCart(); updateCartUI(); }
    function changeQty(itemId, delta){ if(!cart[itemId]) return; cart[itemId].qty += delta; if(cart[itemId].qty<=0) delete cart[itemId]; persistCart(); updateCartUI(); }

    /* -------------------------
       Cart modal UI
       ------------------------- */
    const cartModal = document.getElementById('cart-modal'), cartItemsDiv = document.getElementById('cart-items');
    const cartCountEls = () => document.querySelectorAll('.cart-count');
    function updateCartUI(){
      const totalQty = Object.values(cart).reduce((s,c)=>s + c.qty,0);
      cartCountEls().forEach(el=>el.textContent = totalQty);
      cartItemsDiv.innerHTML = '';
      let total = 0;
      if(!totalQty){ cartItemsDiv.innerHTML = '<p style="color:var(--gray)">Your cart is empty.</p>'; }
      else {
        for(const [id,ci] of Object.entries(cart)){
          const itemTotal = ci.item.price * ci.qty; total += itemTotal;
          const div = document.createElement('div'); div.className='cart-item';
          div.innerHTML = `<div style="flex:1"><div style="font-weight:600">${ci.item.name}</div><div style="color:var(--gray);font-size:13px">₹${ci.item.price} × ${ci.qty} = ₹${itemTotal}</div></div>
            <div style="display:flex;align-items:center;gap:8px"><div class="quantity-controls"><button class="quantity-btn" data-action="dec" data-id="${id}">-</button><span style="min-width:20px;text-align:center">${ci.qty}</span><button class="quantity-btn" data-action="inc" data-id="${id}">+</button></div><button style="background:transparent;border:none;color:var(--warning);cursor:pointer" data-action="remove" data-id="${id}">Remove</button></div>`;
          cartItemsDiv.appendChild(div);
        }
      }
      document.getElementById('cart-total').textContent = formatPrice(total);
      const checkoutTotalEl = document.getElementById('checkout-total'); if(checkoutTotalEl) checkoutTotalEl.textContent = formatPrice(total);
      cartItemsDiv.querySelectorAll('[data-action]').forEach(btn=> btn.addEventListener('click', ev=>{
        const id = ev.target.getAttribute('data-id'), action = ev.target.getAttribute('data-action');
        if(action==='inc') changeQty(id,1); if(action==='dec') changeQty(id,-1); if(action==='remove') removeFromCart(id);
      }));
      persistCart();
    }

    /* -------------------------
       Cart modal open/close & checkout
       ------------------------- */
    function openCartModal(){ updateCartUI(); cartModal.style.display='block'; }
    document.addEventListener('click', function(e){
      if(e.target && e.target.matches && e.target.matches('#cart-button')){ e.preventDefault(); openCartModal(); }
      if(e.target && e.target.matches && e.target.matches('#cart-button-landing')){ e.preventDefault(); openCartModal(); }
    });
    const cartBtnMenu = document.getElementById('cart-button-menu'); if(cartBtnMenu) cartBtnMenu.addEventListener('click', (e)=>{ e.preventDefault(); openCartModal(); });
    const closeCartBtn = document.getElementById('close-cart'); if(closeCartBtn) closeCartBtn.addEventListener('click', ()=> cartModal.style.display='none');
    const checkoutBtn = document.getElementById('checkout-btn'); if(checkoutBtn) checkoutBtn.addEventListener('click', ()=>{ cartModal.style.display='none'; showCheckout(); });

    /* -------------------------
       Navigation helper
       ------------------------- */
    function showPage(pageId){
      document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
      const page = document.getElementById(pageId); if(page) page.classList.add('active');
      window.scrollTo(0,0);
      updateCartUI();
      // if landing-> hide header sign-in etc. The header is part of page content so it's fine.
    }

    /* -------------------------
       Filters, search & find-food
       ------------------------- */
    document.querySelectorAll('.filter-item').forEach(item=>{
      item.addEventListener('click', (e)=>{ e.preventDefault(); const cat=item.getAttribute('data-category'); const filtered = restaurants.filter(r=> r.cuisine.toLowerCase().includes(cat.toLowerCase()) || r.name.toLowerCase().includes(cat.toLowerCase())); renderRestaurants(filtered); showToast(`Filtered by ${cat}`); showPage('home-page'); });
    });
    const searchInput = document.getElementById('search-input');
    if(searchInput) searchInput.addEventListener('input', (e)=>{ const q=e.target.value.trim().toLowerCase(); if(!q) return renderRestaurants(restaurants); const filtered = restaurants.filter(r=> r.name.toLowerCase().includes(q) || r.cuisine.toLowerCase().includes(q)); renderRestaurants(filtered); });
    const findFoodBtn = document.getElementById('find-food');
    if(findFoodBtn) findFoodBtn.addEventListener('click', ()=>{ const loc = document.getElementById('delivery-location').value.trim(); if(!loc){ showToast('Please enter your delivery location'); return; } showToast(`Showing restaurants near ${loc}`); renderRestaurants(restaurants); showPage('home-page'); });

    /* -------------------------
       Checkout flow & place order
       ------------------------- */
    function showCheckout(){
      const totalQty = Object.values(cart).reduce((s,c)=>s + c.qty,0);
      if(!totalQty){ showToast('Your cart is empty'); return; }
      renderCheckoutPage(); showPage('checkout-page');
    }
    function renderCheckoutPage(){
      const checkoutItems = document.getElementById('checkout-items'); checkoutItems.innerHTML=''; let total=0;
      for(const [id,ci] of Object.entries(cart)){ const itemTotal=ci.qty*ci.item.price; total+=itemTotal; const div=document.createElement('div'); div.style.display='flex'; div.style.justifyContent='space-between'; div.style.padding='8px 0'; div.innerHTML=`<div>${ci.item.name} × ${ci.qty}</div><div>₹${formatPrice(itemTotal)}</div>`; checkoutItems.appendChild(div); }
      document.getElementById('checkout-total').textContent = formatPrice(total);
      // payment toggles
      const pm=document.getElementById('payment-method'), cardDetails=document.getElementById('card-details'), upiDetails=document.getElementById('upi-details');
      if(pm){ pm.value=''; if(cardDetails) cardDetails.style.display='none'; if(upiDetails) upiDetails.style.display='none';
        pm.onchange = (e)=>{ if(cardDetails) cardDetails.style.display = e.target.value==='card' ? 'block' : 'none'; if(upiDetails) upiDetails.style.display = e.target.value==='upi' ? 'block' : 'none'; };
      }
    }

    const placeOrderBtn = document.getElementById('place-order-btn');
    if(placeOrderBtn) placeOrderBtn.addEventListener('click', (ev)=>{ ev.preventDefault(); placeOrder(); });

    function placeOrder(){
      const name=document.getElementById('name').value.trim(); const phone=document.getElementById('phone').value.trim(); const address=document.getElementById('address').value.trim(); const city=document.getElementById('city').value.trim(); const pincode=document.getElementById('pincode').value.trim(); const payment=document.getElementById('payment-method').value;
      if(!name||!phone||!address||!city||!pincode){ showToast('Please fill in all delivery details'); return; }
      if(!payment){ showToast('Please select a payment method'); return; }
      if(payment==='card'){ const cn=document.getElementById('card-number').value.trim(); const cvv=document.getElementById('cvv').value.trim(); if(!cn||!cvv){ showToast('Please enter card details'); return; } }
      if(payment==='upi'){ const upi=document.getElementById('upi-id').value.trim(); if(!upi){ showToast('Please enter UPI id'); return; } }

      // create order object
      const orderId = 'SK' + Math.floor(Math.random()*900000 + 10000);
      const orderTime = new Date().toISOString();
      const items = Object.values(cart).map(ci=>({ id:ci.item.id, name:ci.item.name, qty:ci.qty, price:ci.item.price }));
      const total = items.reduce((s,i)=>s + i.qty*i.price,0);
      lastOrder = { orderId, orderTime, items, total, status: 'Confirmed', history: [{ time: orderTime, status: 'Order Confirmed' }] };
      persistLastOrder();

      // clear cart
      cart = {}; persistCart(); updateCartUI();

      // show confirmation and start tracking simulation
      const orderIdEl = document.getElementById('order-id'); if(orderIdEl) orderIdEl.textContent = orderId;
      const orderEstEl = document.getElementById('order-est'); if(orderEstEl) orderEstEl.textContent = (25 + Math.floor(Math.random()*25)) + ' minutes';
      const orderConf = document.getElementById('order-confirmation'); if(orderConf) orderConf.style.display='block';
      showToast('Order placed successfully');

      simulateTrackingForOrder(lastOrder.orderId);
    }

    /* -------------------------
       Tracking simulation
       ------------------------- */
    const simulatedStatusSequence = [
      { key: 'Preparing', label: 'Preparing' , delay: 4000 },
      { key: 'Ready', label: 'Ready for Pickup', delay: 4000 },
      { key: 'Out', label: 'Out for Delivery', delay: 6000 },
      { key: 'Delivered', label: 'Delivered', delay: 3000 }
    ];

    function simulateTrackingForOrder(orderId){
      let idx = 0;
      function step(){
        if(!lastOrder || lastOrder.orderId !== orderId) return;
        const now = new Date().toISOString();
        const statusObj = simulatedStatusSequence[idx];
        if(!statusObj) return;
        lastOrder.status = statusObj.label;
        lastOrder.history.push({ time: now, status: statusObj.label });
        persistLastOrder();
        // if on orders page and tracking same id, refresh
        const trackInput = document.getElementById('track-order-input');
        const trackResult = document.getElementById('track-result');
        if(trackInput && trackResult && trackInput.value.trim() === orderId) renderTrackResult(lastOrder);
        idx++;
        if(idx < simulatedStatusSequence.length){ setTimeout(step, statusObj.delay); } else {}
      }
      setTimeout(step, 1200);
    }

    function renderTrackResult(order){
      const out = document.getElementById('track-result');
      if(!order){ out.innerHTML = '<p style="color:var(--gray)">No order found.</p>'; return; }
      let html = `<div style="background:#fff;padding:15px;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.06)"><h3>Order ${order.orderId}</h3><p>Status: <strong>${order.status}</strong></p><div class="progress"><div class="progress-bar" id="progress-bar"></div></div><ul style="margin-top:12px">`;
      for(const h of order.history){ const t=new Date(h.time); html += `<li style="margin-bottom:6px"><strong>${h.status}</strong> — ${t.toLocaleTimeString()}</li>`; }
      html += '</ul></div>'; out.innerHTML = html;
      const idx = simulatedStatusSequence.findIndex(s => s.label === order.status);
      let perc = 0; if(idx === -1) perc = 0; else perc = Math.min(100, Math.round(((idx+1) / simulatedStatusSequence.length) * 100));
      const bar = document.getElementById('progress-bar'); if(bar) bar.style.width = perc + '%';
    }

    const trackOrderBtn = document.getElementById('track-order-btn');
    if(trackOrderBtn) trackOrderBtn.addEventListener('click', ()=>{
      const id = document.getElementById('track-order-input').value.trim();
      if(!id) return showToast('Enter order id to track');
      if(lastOrder && lastOrder.orderId === id){ renderTrackResult(lastOrder); } else { document.getElementById('track-result').innerHTML = '<p style="color:var(--gray)">Order not found or session expired.</p>'; }
    });

    const trackNowBtn = document.getElementById('track-now-btn');
    if(trackNowBtn) trackNowBtn.addEventListener('click', ()=>{ const oc = document.getElementById('order-confirmation'); if(oc) oc.style.display='none'; showPage('orders-page'); if(lastOrder){ document.getElementById('track-order-input').value = lastOrder.orderId; renderTrackResult(lastOrder);} });
    const closeConfirmationBtn = document.getElementById('close-confirmation');
    if(closeConfirmationBtn) closeConfirmationBtn.addEventListener('click', ()=>{ const oc = document.getElementById('order-confirmation'); if(oc) oc.style.display='none'; showPage('home-page'); });

    /* -------------------------
       Meal plan button hookup
       ------------------------- */
    document.querySelectorAll('.add-plan-btn').forEach(btn=>{
      btn.addEventListener('click', (e)=>{
        const title = e.target.getAttribute('data-title'); const price = parseInt(e.target.getAttribute('data-price')) || 0;
        const id = 'plan-' + title.replace(/\s+/g,'-').toLowerCase();
        const item = { id, name: title + ' (Subscription)', description: 'Monthly subscription', price };
        addToCart(item, 9999);
      });
    });

    /* -------------------------
       Signup/login button hookups
       ------------------------- */
    const goLogin = document.getElementById('go-login'); if(goLogin) goLogin.addEventListener('click', ()=> showPage('login-page'));
    const goSignup = document.getElementById('go-signup'); if(goSignup) goSignup.addEventListener('click', ()=> showPage('signup-page'));
    const contGuest = document.getElementById('continue-guest'); if(contGuest) contGuest.addEventListener('click', ()=>{ showPage('home-page'); renderRestaurants(restaurants); });

    // Login action
    const btnLogin = document.getElementById('btn-login');
    if(btnLogin) btnLogin.addEventListener('click', ()=>{
      const email = document.getElementById('login-email').value.trim();
      const pass = document.getElementById('login-password').value.trim();
      if(!email || !pass) return showToast('Enter both email and password');
      const res = loginUser(email, pass);
      if(!res.ok) return showToast(res.message);
      showToast('Logged in as ' + currentUser.name);
      showPage('home-page');
    });

    // Signup action
    const btnSignup = document.getElementById('btn-signup');
    if(btnSignup) btnSignup.addEventListener('click', ()=>{
      const name = document.getElementById('signup-name').value.trim();
      const email = document.getElementById('signup-email').value.trim();
      const pass = document.getElementById('signup-password').value.trim();
      if(!name || !email || !pass) return showToast('Fill all fields');
      const res = signupUser(name, email, pass);
      if(!res.ok) return showToast(res.message);
      showToast('Account created — welcome ' + name);
      showPage('home-page');
    });

    /* -------------------------
       Fallback pages creation & init
       ------------------------- */
    ['recipes-page','nutrition-page','cooking-classes-page','dining-page','nightlife-page'].forEach(pid=>{
      if(!document.getElementById(pid)){
        const div=document.createElement('div'); div.className='page'; div.id=pid;
        div.innerHTML = `<header><div class="container"><div class="header-top"><a href="#" class="logo" onclick="showPage('home-page')"><i class="fas fa-utensils"></i> Spice & Kitchen</a></div><div class="header-nav"><a href="#" onclick="showPage('home-page')">← Back to Home</a></div></div></header><div class="container" style="padding:30px 0;"><h1 class="section-title">${pid.replace('-',' ')}</h1><p style="color:var(--gray)">Demo page</p></div>`;
        document.body.appendChild(div);
      }
    });

    /* -------------------------
       Initialize UI & header
       ------------------------- */
    renderRestaurants(restaurants);
    updateCartUI();
    updateHeaderForUser();

    // if a lastOrder exists, continue simulating tracking
    if(lastOrder) simulateTrackingForOrder(lastOrder.orderId);

    /* -------------------------
       Universal image fallbacks (placed at end)
       ------------------------- */
    function attachImgFallbacks() {
      document.querySelectorAll('img').forEach(img => {
        if (!img.dataset.fallbackAttached) {
          img.dataset.fallbackAttached = '1';
          const w = img.getAttribute('width') || img.width || 240;
          const h = img.getAttribute('height') || img.height || 120;
          const placeholder = `https://via.placeholder.com/${Math.max(120,w)}x${Math.max(80,h)}?text=Image+unavailable`;
          img.onerror = () => { img.onerror = null; img.src = placeholder; img.style.objectFit = 'cover'; };
        }
      });
    }
    attachImgFallbacks();
    const imageObserver = new MutationObserver(attachImgFallbacks);
    imageObserver.observe(document.body, { childList:true, subtree:true });

    function extractUrlFromBg(bg) {
      if (!bg) return null;
      const m = /url\\((?:'|")?(.*?)(?:'|")?\\)/i.exec(bg);
      return m ? m[1] : null;
    }
    function preloadAndFallbackBackgrounds() {
      document.querySelectorAll('*').forEach(el => {
        const bg = getComputedStyle(el).backgroundImage;
        const url = extractUrlFromBg(bg);
        if (url) {
          const img = new Image();
          img.onload = () => {};
          img.onerror = () => {
            el.style.backgroundImage = "url('https://via.placeholder.com/1200x800?text=Image+unavailable')";
            el.style.backgroundSize = 'cover';
            el.style.backgroundPosition = 'center';
          };
          img.src = url;
        }
      });
    }
    window.addEventListener('load', preloadAndFallbackBackgrounds);
    // also when restaurants are re-rendered
    const originalRenderRestaurants = renderRestaurants;
    // already calling preload after renderRestaurants; safe.

  </script>
</body>
</html>
